# Protocol explanation

## Service discovery

`0x0402{name}7e4f70656e7e{usersInGame}7e` -> `04 02 name~OPEN~1~` (uses `~` as separator)

## `01` messages

```
01 CC CC LL LL 05 20 00 00 00 NN NN 02 DD DD ...
                              |     QQ         |
                              \________________/
                                      |
                                  This can be repeated
```

 - `CC CC`: unsigned integer (16bits) used as a counter (big endian)
 - `LL LL`: Buffer length = LL LL + 6 (LL LL is in little endian)
 - `05`: unsigned integer (16bits) opt code
 - `20 00 00 00` -> That data
 - `NN NN`: Length without QQ (little endian)
 - `QQ`: code Usually `02` (player data) or `00 04` (player init)
 - `DD DD DD DD`: data. Usually first byte is the user id.


```
01 CC CC LL LL 06 20 00 00 00 PP NN NN 02 DD DD ...
                                 |     QQ         |
                                 \________________/
                                         |
                                  This can be repeated
```

 - `CC CC`: unsigned integer (16bits) used as a counter
 - `LL LL`: Buffer length = LL LL + 6 (LL LL is in little endian)
 - `06`: unsigned integer (16bits) opt code
 - `20 00 00 00` -> That data
 - `PP`: Some number related to the session
 - `NN NN`: Length without code (little endian)
 - `QQ`: code? Usually `00 02` or `00 04`
 - `DD DD DD DD`: data. Usually first byte is the user id.

## Handshake

## Multiplayer Hosts

 - `66.175.220.120`
 - `45.79.40.75`
 - `104.237.135.186`
 - `50.116.1.42`
 - `139.162.111.196`
 - `172.105.251.170`


###

Europe: 172.105.251.170

1. Client -> Server (E) Handshake (same as local)

```hex
0000   08 00 01 00 46 d2 02 03 04 4f 74 72 6f            ....F....Otro
```

2. Server (E) -> Client

```hex
0000   00 38 00 0e 01 02 18 00 00 0f 45 75 72 6f 70 65   .8........Europe
0010   2d 4d 61 73 74 65 72 2d 32 ac 69 f9 19 07 56 f6   -Master-2.i...V.
0020   15 18 00 00 0f 45 75 72 6f 70 65 2d 4d 61 73 74   .....Europe-Mast
0030   65 72 2d 31 ac 69 fb aa 07 56 f8 14               er-1.i...V..
```

3. Server starts ping (`0a 00 01 ff`)

4. Client -> Server (E)

```hex
ABCD -> [41 - 5A]
0000   01 00 02 05 00 01 41 42 43 44 07                  ......ABCD.

0100 0001 41 A
0100 0010 42 B
0100 0011 43 C
0100 0100 44 D
0100 0101 45 E
0100 0110 46 F
0100 0111 47 G
0100 1000 48 H
0100 1001 49 I
0100 1010 4A J
0100 1011 4B K
0100 1100 4C L
0100 1101 4D M
0100 1110 4E N
0100 1111 4F O
0101 0000 50 P
0101 0001 51 Q
0101 0010 52 R
0101 0011 53 S
0101 0100 54 T
0101 0101 55 U
0101 0110 56 V
0101 0111 57 W
0101 1000 58 X
0101 1001 59 Y
0101 1010 5A Z

CKUHXQ
0000   01 00 02 05 00 01 b3 a1 1a 80 07                  ...........
1011 0011 1010 0001 0001 1010 1000 0000
1011 0011 1100 0001 0010 1010 1000 0010
1011 0011 1xx0 0001 00xx 1010 1000 00x0

CKUHQX
0000   01 00 02 05 00 01 b3 c1 2a 82 07                  ........*..
1011 0011 1100 0001 0010 1010 1000 0010

VIBQQQ
0000   01 00 02 05 00 01 50 56 00 80 07                  ......PV...
0101 0000 0101 0110 0000 0000 1000 0000

VUPLQQ
0000   01 00 02 05 00 01 80 8d 02 80 07                  ...........
1000 0000 1000 1101 0000 0010 1000 0000

MRRTQQ
0000   01 00 02 05 00 01 66 ac 01 80 07                  ......f....
0110 0110 1010 1100 0000 0001 1000 0000

EDTTWQ
0000   01 00 02 05 00 01 0c 41 0c 80 07                  .......A...
0000 1100 0100 0001 0000 1100 1000 0000

KLOXWQ
0000   01 00 02 05 00 01 ac a8 0b 80 07                  ...........
1010 1100 1010 1000 0000 1011 1000 0000
1010 1100 0010 1000 0000 1001 1000 0001
1010 1100 x010 1000 0000 10x1 1000 000x

KLOXAQ
0000   01 00 02 05 00 01 ac 28 09 81 07                  .......(...
1010 1100 0010 1000 0000 1001 1000 0001

KAGDRQ
0000   01 00 02 05 00 01 9a f2 23 80 07                  ........#..
1001 1010 1111 0010 0010 0011 1000 0000

AKUHXQ
0000   01 00 02 05 00 01 b9 a1 1a 80 07                  ...........
1011 1001 1010 0001 0001 1010 1000 0000

BKUHXQ
0000   01 00 02 05 00 01 b5 a1 1a 80 07                  ...........
1011 0101 1010 0001 0001 1010 1000 0000

CKUHXQ
0000   01 00 02 05 00 01 b3 a1 1a 80 07                  ...........
1011 0011 1010 0001 0001 1010 1000 0000

DKUHXQ
0000   01 00 02 05 00 01 aa a1 1a 80 07                  ...........
1010 1010 1010 0001 0001 1010 1000 0000

EKUHXQ
0000   01 00 02 05 00 01 a8 a1 1a 80 07                  ...........
1010 1000 1010 0001 0001 1010 1000 0000

FKUHXQ
0000   01 00 02 05 00 01 ab a1 1a 80 07                  ...........
1010 1011 1010 0001 0001 1010 1000 0000

GKUHXQ
0000   01 00 02 05 00 01 ac a1 1a 80 07                  ...........
1010 1100 1010 0001 0001 1010 1000 0000

HKUHXQ
0000   01 00 02 05 00 01 ad a1 1a 80 07                  ...........
1010 1101 1010 0001 0001 1010 1000 0000

IKUHXQ
0000   01 00 02 05 00 01 b6 a1 1a 80 07                  ...........
1011 0110 1010 0001 0001 1010 1000 0000

JKUHXQ
0000   01 00 02 05 00 01 af a1 1a 80 07                  ...........
1010 1111 1010 0001 0001 1010 1000 0000

KKUHXQ
0000   01 00 02 05 00 01 b0 a1 1a 80 07                  ...........
1011 0000 1010 0001 0001 1010 1000 0000

MKUHXQ
0000   01 00 02 05 00 01 b8 a1 1a 80 07                  ...........
1011 1000 1010 0001 0001 1010 1000 0000

NKUHXQ
0000   01 00 02 05 00 01 b7 a1 1a 80 07                  ...........
1011 0111 1010 0001 0001 1010 1000 0000

OKUHXQ

PKUHXQ

QKUHXQ

RKUHXQ

SKUHXQ

TKUHXQ

UKUHXQ

VKUHXQ
0000   01 00 02 05 00 01 b4 a1 1a 80 07                  ...........
1011 0100 1010 0001 0001 1010 1000 0000

WKUHXQ

XKUHXQ

YKUHXQ

ZKUHXQ
0000   01 00 02 05 00 01 b1 a1 1a 80 07                  ...........
1011 0001 1010 0001 0001 1010 1000 0000

VVVVVV
0000   01 00 02 05 00 01 1c 32 50 96 07                  .......2P..
0001 1100 0011 0010 0101 0000 1001 0110

AAAAAA
0000   01 00 02 05 00 01 a3 3e e4 9b 07                  .......>...
1010 0011 0011 1110 1110 0100 1001 1011

BAAAAA
0000   01 00 02 05 00 01 9f 3e e4 9b 07                  .......>...
1001 1111 0011 1110 1110 0100 1001 1011

AAAAAB
0000   01 00 02 05 00 01 a3 be 99 97 07                  ...........
1010 0011 1011 1110 1001 1001 1001 0111

AAAAAC
0000   01 00 02 05 00 01 a3 7e 74 95 07                  .......~t..
1010 0011 0111 1110 0111 0100 1001 0101

AABAAA
0000   01 00 02 05 00 01 a3 2e e4 9b 07                  ...........
1010 0011 0010 1110 1110 0100 1001 1011

BBBBBBB
0000   01 00 02 05 00 01 37 ce 6d 97 07                  ......7.m..
0011 0111 1100 1110 0110 1101 1001 0111

BKFHAY
0000   01 00 02 05 00 01 b5 a5 6a 86 07                  ........j..
1011 0101 1010 0101 0110 1010 1000 0110

BJGOAR
0000   01 00 02 05 00 01 9b 71 47 84 07                  .......qG..
1001 1011 0111 0001 0100 0111 1000 0100

BFLKXV
0000   01 00 02 05 00 01 33 39 90 95 07                  ......39...
0011 0011 0011 1001 1001 0000 1001 0101

QQQQQQ
0000   01 00 02 05 00 01 00 00 00 80 07                  ...........
0000 0000 0000 0000 0000 0000 1000 0000

QQQQQZ
0000   01 00 02 05 00 01 00 a0 3c 92 07                  ........<..
0000 0000 1010 0000 0011 1100 1001 0010

QQQQQR
0000   01 00 02 05 00 01 00 e0 37 83 07                  ........7..
0000 0000 1110 0000 0011 0111 1000 0011

RQQQQQ
0000   01 00 02 05 00 01 03 00 00 80 07                  ...........
0000 0011 0000 0000 0000 0000 1000 0000

SQQQQQ
0000   01 00 02 05 00 01 09 00 00 80 07                  ...........
0000 1001 0000 0000 0000 0000 1000 0000

XQQQQQ
0000   01 00 02 05 00 01 02 00 00 80 07                  ...........
0010 0000

YQQQQQ
0000   01 00 02 05 00 01 05 00 00 80 07                  ...........
0101 0000

ZQQQQQ
0000   01 00 02 05 00 01 11 00 00 80 07                  ...........
0001 0001 0000 0000 0000 0000 1000 0000

QRQQQQ
0000   01 00 02 05 00 01 4e 00 00 80 07                  ......N....
0100 1110 0000 0000 0000 0000 1000 0000

QZQQQQ
0000   01 00 02 05 00 01 ba 01 00 80 07                  ...........
1011 1010

000000
0000   01 00 02 05 00 01 00 00 00 00 07                  ...........

000001
0000   01 00 02 05 00 01 00 00 00 00 07                  ...........

ABCDEF
0000   01 00 02 05 00 01 3b be 25 8c 07                  ......;.%..
0011 1011

ABAAAA
0000   01 00 02 05 00 01 3b 3e e4 9b 07                  ......;>...
0011 1011

ABFUQY
0000   01 00 02 05 00 01 3b fe 62 85 07                  ......;.b..
0011 1011

AAQQQQ
0000   01 00 02 05 00 01 a3 02 00 80 07                  ...........
1010 0011

ABQQQQ
0000   01 00 02 05 00 01 3b 02 00 80 07                  ......;....
0011 1011

ACQQQQ
0000   01 00 02 05 00 01 07 02 00 80 07                  ...........
0000 0111

ADQQQQ
0000   01 00 02 05 00 01 1d 01 00 80 07                  ...........
0001 1101

AEQQQQ
0000   01 00 02 05 00 01 e9 00 00 80 07                  ...........
1110 1001

AFQQQQ
0000   01 00 02 05 00 01 37 01 00 80 07                  ......7....
0011 0111

AGQQQQ
0000   01 00 02 05 00 01 51 01 00 80 07                  ......Q....
0101 0001

AHQQQQ
0000   01 00 02 05 00 01 6b 01 00 80 07                  ......k....
0110 1011

AIQQQQ
0000   01 00 02 05 00 01 55 02 00 80 07                  ......U....
0101 0101

AJQQQQ
0000   01 00 02 05 00 01 9f 01 00 80 07                  ...........
1001 1111

AKQQQQ
0000   01 00 02 05 00 01 b9 01 00 80 07                  ...........
1011 1001

ALQQQQ
0000   01 00 02 05 00 01 b5 00 00 80 07                  ...........
1011 0101

AMQQQQ
0000   01 00 02 05 00 01 89 02 00 80 07                  ...........
1000 1001

AOQQQQ
0000   01 00 02 05 00 01 ed 01 00 80 07                  ...........
1110 1101

APQQQQ
0000   01 00 02 05 00 01 cf 00 00 80 07                  ...........
1100 1111

AQQQQQ
0000   01 00 02 05 00 01 19 00 00 80 07                  ...........
0001 1001

ARQQQQ
0000   01 00 02 05 00 01 67 00 00 80 07                  ......g....
0110 0111

ASQQQQ
0000   01 00 02 05 00 01 03 01 00 80 07                  ...........
0000 0011

ATQQQQ
0000   01 00 02 05 00 01 81 00 00 80 07                  ...........
1000 0001

AUQQQQ
0000   01 00 02 05 00 01 85 01 00 80 07                  ...........
1000 0101

AVQQQQ
0000   01 00 02 05 00 01 21 02 00 80 07                  ......!....
0010 0001

AWQQQQ
0000   01 00 02 05 00 01 33 00 00 80 07                  ......3....
0011 0011

AXQQQQ
0000   01 00 02 05 00 01 4d 00 00 80 07                  ......M....
0100 1101

AYQQQQ
0000   01 00 02 05 00 01 9b 00 00 80 07                  ...........
1001 1011

AZQQQQ
0000   01 00 02 05 00 01 d3 01 00 80 07                  ...........
1101 0011

22.. ...1
|       \_> Depnde de 1ra letra
|
Depeenden de 2da letra




BAQQQQ
0000   01 00 02 05 00 01 9f 02 00 80 07                  ...........
1001 1111

AQJAOS
0000   01 00 02 05 00 01 19 24 70 8a 07                  .......$p..
0001 1001

QAJAOS
0000   01 00 02 05 00 01 8a 26 70 8a 07                  .......&p..
1000 1010

PPPPPP
0000   01 00 02 05 00 01 bd 44 cf 87 07                  .......D...
1011 1101

```

5. Server (E) -> Client

```hex
0000   01 00 01 06 00 0d 97 ec dd 9e 07 56               ...........V
                         II II II II
II II II II: Ip address 151.236.221.158
```

6. Client -> Server (E) (The server also sends this close message)

```hex
0000   09                                                .
```

7. Client -> Another Server (`151.236.221.158`)

```hex
0000   08 00 01 00 46 d2 02 03 04 4f 74 72 6f            ....F....Otro
```
8. Server starts ping (`0a 00 01 ff`)

9. Client -> Server

```hex
0000   01 00 02 05 00 01 b3 a1 1a 80 07                  ...........
```

10. Server -> Client

```hex
0000   01 00 01 10 00 07 b3 a1 1a 80 5c cc 10 00 33 cc   ..........\...3.
0010   10 00 01 b3 98 43 06 00 0a b3 a1 1a 80 01 00      .....C.........
```

11. Server -> Client

```hex
0000   01 00 02 0b 00 05 b3 a1 1a 80 04 00 02 04 12 00   ................
0010   ff                                                .
```

12. Client -> Server

```hex
0000   01 00 03 15 00 05 b3 a1 1a 80 0e 00 06 dc 98 43   ...............C
0010   0a 4f 6e 6c 69 6e 65 47 61 6d 65                  .OnlineGame
```

13. Server -> Client

```hex
0000   01 00 03 5b 00 06 b3 a1 1a 80 dc 98 43 0c 00 04   ...[........C...
0010   02 fe ff ff ff 0f 00 01 01 00 00 01 21 00 04 03   ............!...
0020   fe ff ff ff 0f 00 02 02 10 00 01 01 00 07 61 6e   ..............an
0030   64 72 6f 69 64 07 1c 00 00 00 00 03 01 00 01 00   droid...........
0040   1e 00 04 04 b3 98 43 01 03 04 02 00 01 00 00 05   ......C.........
0050   00 00 01 06 0a 00 01 06 00 fd 7a 8f 87 ff 7f ff   ..........z.....
0060   7f                                                .
```

14. Server -> Client

```hex
0000   01 00 04 66 00 05 b3 a1 1a 80 1e 00 04 04 dc 98   ...f............
0010   43 01 03 07 02 00 01 01 01 08 00 00 01 09 0a 00   C...............
0020   01 00 00 ff 7f ff 7f ff 7f ff 7f 2f 00 02 07 02   .........../....
0030   2c 03 0a 02 00 00 00 00 00 00 80 3f 00 00 80 3f   ,..........?...?
0040   00 00 c0 3f 00 00 34 42 01 01 02 01 00 00 00 02   ...?..4B........
0050   01 0f 00 00 00 78 00 00 00 01 0f 01 01 0c 00 02   .....x..........
0060   02 1e 07 00 01 00 00 00 00 00 00 00               ............
```

15. Client -> Server

```hex
0000   01 00 04 11 00 06 b3 a1 1a 80 b3 98 43 07 00 02   ............C...
0010   07 05 04 4f 74 72 6f                              ...Otro
```

16. Client -> Server

```hex
0000   01 00 05 0d 00 06 b3 a1 1a 80 b3 98 43 03 00 02   ............C...
0010   07 07 04                                          ...
```

17. Client -> Server

```hex
0000   01 00 06 16 00 05 b3 a1 1a 80 03 00 02 07 11 00   ................
0010   03 00 02 07 09 46 03 00 02 07 0a 08               .....F......
```

18. Server -> Client

```hex
0000   01 00 05 27 00 05 b3 a1 1a 80 07 00 02 07 06 04   ...'............
0010   4f 74 72 6f 03 00 02 07 08 04 10 00 02 02 1e 0b   Otro............
0020   00 01 04 4f 74 72 6f 04 00 00 00 00 00            ...Otro......
```

19. Server -> Client

```hex
0000   01 00 06 17 00 05 b3 a1 1a 80 10 00 02 02 1e 0b   ................
0010   00 01 04 4f 74 72 6f 04 46 00 08 00 00            ...Otro.F....
```




